<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>암산 퀴즈 — 곱셈/제곱/거듭제곱/이차방정식/행렬계산/고유값</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif; margin: 24px; }
    #app { max-width: 600px; margin: 0 auto; }
    .q { font-size: 26px; font-weight: 700; margin: 16px 0; white-space: pre-line; }
    .row { display: flex; gap: 8px; }
    input[type="text"] { flex: 1; padding: 10px 12px; font-size: 16px; }
    button { padding: 10px 14px; font-size: 16px; cursor: pointer; }
    .msg { margin-top: 12px; font-weight: 700; }
    .ok { color: #2e7d32; }
    .bad { color: #c62828; }
    .hint { color: #6b7280; font-size: 13px; margin-top: 4px; }
  </style>
</head>
<body>
  <div id="app" role="application">
    <h1 style="margin:0">암산 퀴즈</h1>
    <p class="hint">무작위로 여러 유형의 문제를 출제합니다.</p>

    <div class="q" id="q">다음 문제를 눌러 시작하세요.</div>

    <div class="row">
      <input id="answer" type="text" placeholder="정답 입력 (예: 2,3)" disabled />
      <button id="submit" disabled>제출</button>
      <button id="next" type="button">다음 문제</button>
    </div>

    <div id="msg" class="msg"></div>
  </div>

  <script>
    const $ = (s) => document.querySelector(s);
    const state = { current: null };

    // 출제 비율을 직접 지정 (가중치)
    // 0:(10^n−a)(10^n+a), 1:n², 2:2ⁿ, 3:(10^n+a)², 4:(10^n−a)², 5:이차방정식
    // 0:(10^n−a)(10^n+a), 1:n², 2:2ⁿ, 3:(10^n+a)², 4:(10^n−a)², 5:이차방정식, 6:2×2 대칭행렬 고유값
const WEIGHT = { 0: 1, 1: 1, 2: 1, 3: 1, 4: 1, 5: 3, 6: 3, 7: 3};

    function randint(lo, hi) { return Math.floor(Math.random() * (hi - lo + 1)) + lo; }

    function weightedChoice(weightMap) {
      const modes = Object.keys(weightMap).map(Number);
      const weights = modes.map(k => Math.max(0, Number(weightMap[k] || 0)));
      const total = weights.reduce((a, b) => a + b, 0);
      let r = Math.random() * total;
      for (let i = 0; i < modes.length; i++) {
        r -= weights[i];
        if (r < 0) return modes[i];
      }
      return modes[modes.length - 1];
    }

    function makeProblem() {
      const mode = weightedChoice(WEIGHT);

      if (mode === 0) {
        const n = randint(1, 2);
        const ten = 10 ** n;
        const a = randint(1, 9);
        const x = ten - a;
        const y = ten + a;
        return { text: `${x} × ${y} = ?`, answer: (ten ** 2 - a * a).toString() };
      } else if (mode === 1) {
        const n = randint(2, 19);
        return { text: `${n} × ${n} = ?`, answer: (n * n).toString() };
      } else if (mode === 2) {
        const n = randint(2, 11);
        return { text: `2^${n} = ?`, answer: (2 ** n).toString() };
      } else if (mode === 3) {
        const n = randint(1, 2);
        const ten = 10 ** n;
        const a = randint(1, 9);
        const x = ten + a;
        return { text: `${x} × ${x} = ?`, answer: (x * x).toString() };
      } else if (mode === 4) {
        const n = randint(1, 2);
        const ten = 10 ** n;
        const a = randint(1, 9);
        const x = ten - a;
        return { text: `${x} × ${x} = ?`, answer: (x * x).toString() };
      } else if (mode === 5) {
        // quadratic equation: integer roots in [-9,9]
        let r1 = randint(-9, 9);
        let r2 = randint(-9, 9);
        while (r1 === 0 && r2 === 0) { r1 = randint(-9, 9); r2 = randint(-9, 9); }
        const b = -(r1 + r2);
        const c = r1 * r2;
        const bstr = b === 0 ? '' : (b > 0 ? ` + ${b}x` : ` - ${Math.abs(b)}x`);
        const cstr = c === 0 ? '' : (c > 0 ? ` + ${c}` : ` - ${Math.abs(c)}`);
        const text = `x²${bstr}${cstr} = 0
(두 근을 입력, 예: -3,5)`;
        const ans = [r1, r2].sort((a,b)=>a-b).join(',');
        return { text, answer: ans };
      } else if (mode === 6) {
        // mode 6: 2x2 symmetric matrix eigenvalues (integer eigenvalues)
        // Pick integer eigenvalues r1,r2 in [-9,9] with same parity so that a=(r1+r2)/2, b=(r1-r2)/2 are integers.
        let m = randint(-3, 3), n = randint(-3, 3);
		let d = randint(-3, 3);
		const b = m * n;
		const a = d + m * m - n * n;
		const r1 = d + m * m;
		const r2 = d - n * n;
        const text = `다음 대칭행렬의 고유값을 구하시오:
[ ${a}  ${b} ]
[ ${b}  ${d} ]
(두 값을 입력, 예: -3,5)`;
        const ans = [r1, r2].sort((x,y)=>x-y).join(',');
        return { text, answer: ans };
      } else {
		const a = randint(-9, 9), b = randint(-9, 9);
		const c = randint(-9, 9), d = randint(-9, 9);
		const x = randint(-9, 9), y = randint(-9, 9);
		const r1 = a * x + b * y;
		const r2 = c * x + d * y;
		const text = `다음 곱을 계산하시오:
		[ ${a} ${b} ] [ ${x} ]
		[ ${c} ${d} ] [ ${y} ]
		(두 값을 입력, 예: ${r1},${r2})`;
		const ans = [r1, r2].sort((u,v)=>u-v).join(',');
		return { text, answer: ans, meta: { unordered: true } };
	  }
    } 

    function next() {
      state.current = makeProblem();
      $('#q').textContent = state.current.text;
      $('#answer').value = '';
      $('#answer').disabled = false;
      $('#submit').disabled = false;
      $('#msg').textContent = '';
      $('#answer').focus();
    }

    function submit() {
      if (!state.current) return;
      const raw = $('#answer').value.trim();
      if (!raw) return;
      let val = raw.replace(/\s+/g, '');
      if (val.includes(',')) {
        const parts = val.split(',').map(Number).sort((a, b) => a - b);
        val = parts.join(',');
      }
      const ok = val === state.current.answer;
      const msg = ok ? '정답' : `틀렸습니다. 정답: ${state.current.answer}`;
      $('#msg').textContent = msg;
      $('#msg').className = 'msg ' + (ok ? 'ok' : 'bad');
      $('#answer').disabled = true;
      $('#submit').disabled = true;
      $('#next').focus();
    }

    $('#next').addEventListener('click', next);
    $('#submit').addEventListener('click', submit);

    window.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        if (!$('#submit').disabled) {
          e.preventDefault();
          submit();
        } else {
          e.preventDefault();
          next();
        }
      }
    });

    $('#q').textContent = '다음 문제를 눌러 시작하세요.';
  </script>
</body>
</html>
